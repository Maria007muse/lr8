full code (не помещается весь)
https://disk.yandex.ru/d/AkvFemGYsJGtqQ
